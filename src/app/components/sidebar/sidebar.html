<div class="flex h-[calc(100vh-2rem)] pointer-events-auto">
  
  <!-- Barra de Ícones (Sempre visível) -->
  <div class="w-16 flex flex-col items-center py-6 gap-6 glass-panel rounded-2xl mr-4 z-20">
    <!-- Logo -->
    <div class="w-10 h-10 bg-teal-700 rounded-lg flex items-center justify-center text-white font-bold mb-4 shadow-lg">
      DF
    </div>

    <!-- Botão Camadas -->
    <button (click)="toggleTab('layers')"
            class="p-3 rounded-xl transition-all duration-300 hover:bg-white/50 relative group"
            [ngClass]="{'bg-white text-teal-700 shadow-md': activeTab() === 'layers', 'text-gray-600': activeTab() !== 'layers'}">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
      </svg>
      <span class="absolute left-14 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">
        Camadas
      </span>
    </button>

    <!-- Botão Info -->
    <button (click)="toggleTab('info')"
            class="p-3 rounded-xl transition-all duration-300 hover:bg-white/50 relative group"
            [ngClass]="{'bg-white text-teal-700 shadow-md': activeTab() === 'info', 'text-gray-600': activeTab() !== 'info'}">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="absolute left-14 bg-gray-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">
        Sobre
      </span>
    </button>
  </div>

  <!-- Painel Expansível -->
  @if (activeTab()) {
    <div class="w-80 glass-panel rounded-2xl p-6 flex flex-col z-10 animate-slide-in overflow-hidden">
      <!-- Conteúdo Camadas -->
       @if (activeTab() === 'layers') {
        <div class="flex flex-col h-full">
          <h2 class="text-xl font-bold text-gray-800 mb-2">Camadas</h2>
          <p class="text-sm text-gray-500 mb-6">Gerencie a visualização do mapa.</p>

          <!-- Seletor de Mapa Base -->
          <div class="mb-6">
            <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Mapa Base</h3>
            <div class="grid grid-cols-2 gap-2">
              @for (base of mapStore.baseLayers; track base) {
                <button (click)="setBaseLayer(base.id)"
                        class="p-2 rounded-lg text-sm text-left transition-all border"
                        [ngClass]="mapStore.currentBaseLayer().id === base.id ? 
                          'bg-teal-50 border-teal-500 text-teal-700 font-medium shadow-sm' : 
                          'bg-white/40 border-transparent hover:bg-white/60 text-gray-600'">
                  {{ base.name }}
                </button>
              }
            </div>
          </div>

          <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Sobreposições</h3>
          <div class="flex-1 overflow-y-auto custom-scrollbar pr-2 space-y-4">
            @for (layer of mapStore.layers(); track layer) {
              <div class="bg-white/40 p-3 rounded-lg border border-white/50 hover:bg-white/60 transition-colors">
                <div class="flex items-center justify-between mb-2">
                  <span class="font-medium text-gray-700">{{ layer.name }}</span>
                  
                  <!-- Toggle Switch -->
                  <button (click)="toggleLayer(layer.id)"
                          class="w-10 h-5 rounded-full relative transition-colors duration-300 focus:outline-none"
                          [ngClass]="layer.visible ? 'bg-teal-600' : 'bg-gray-300'">
                    <div class="w-3 h-3 bg-white rounded-full absolute top-1 transition-transform duration-300 shadow-sm"
                        [ngClass]="layer.visible ? 'left-6' : 'left-1'"></div>
                  </button>
                </div>

                <p class="text-xs text-gray-500 mb-3">{{ layer.description }}</p>

                <!-- Slider Opacidade -->
                @if (layer.visible) {
                  <div class="space-y-1 animate-fade-in">
                    <div class="flex justify-between text-xs text-gray-500">
                      <span>Opacidade</span>
                      <span>{{ (layer.opacity * 100) | number:'1.0-0' }}%</span>
                    </div>
                    <input type="range" 
                          [min]="0" [max]="1" [step]="0.1" 
                          [value]="layer.opacity"
                          (input)="updateOpacity(layer.id, $event)"
                          class="w-full h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                  </div>
                }
              </div>
            }
          </div>
        </div>
      }

      <!-- Conteúdo Info -->
      @if (activeTab() === 'info') {
        <div class="flex flex-col h-full">
          <h2 class="text-xl font-bold text-gray-800 mb-4">Sobre o Projeto</h2>
          <div class="prose prose-sm text-gray-600 overflow-y-auto custom-scrollbar pr-2">
            <p class="mb-4">
              <strong>DF no Mapa</strong> é um projeto de visualização e análise de dados geoespaciais do Distrito Federal.
            </p>
            <p class="mb-4">
              Explore dados sobre Ilhas de Calor Urbanas (ICU), uso do solo e vegetação.
            </p>
            <h3 class="font-bold text-gray-800 mt-4 mb-2">Como usar:</h3>
            <ul class="list-disc pl-4 space-y-1">
              <li>Use a barra lateral para ativar camadas.</li>
              <li>Use a linha do tempo abaixo para mudar o ano.</li>
              <li>Navegue pelo mapa para explorar as regiões.</li>
            </ul>
          </div>
        </div>
      }
    </div>
  }

</div>
